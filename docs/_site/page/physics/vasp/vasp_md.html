<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>VASPでの第一原理MD計算のやり方 | personal website</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="VASPでの第一原理MD計算のやり方" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<meta property="og:description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<link rel="canonical" href="http://localhost:4000/page/physics/vasp/vasp_md.html" />
<meta property="og:url" content="http://localhost:4000/page/physics/vasp/vasp_md.html" />
<meta property="og:site_name" content="personal website" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="VASPでの第一原理MD計算のやり方" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.","headline":"VASPでの第一原理MD計算のやり方","url":"http://localhost:4000/page/physics/vasp/vasp_md.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=c90158fd34f66e4f63b4da45038b5d6170d798eb">
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
    

<!--  -->

  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1><a href="http://localhost:4000/">personal website</a></h1>

        

        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>

        
        <p class="view"><a href="https://github.com/dirac6582/dirac6582.github.io.git">View the Project on GitHub <small>dirac6582/dirac6582.github.io.git</small></a></p>
        

        

        
      </header>
      <section>

      
<h1 id="vaspでの第一原理md計算のやり方">VASPでの第一原理MD計算のやり方</h1>

<h2 id="入力出力ファイル">入力/出力ファイル</h2>
<p><a href="https://www.vasp.at/wiki/index.php/Category:Molecular_dynamics">VASPのマニュアル</a>も確認してください．</p>

<p>標準的な分子動力学計算の入力ファイルは、INCARにいくつかMD用のフラグが必要なことを除けば他の計算方法と同じだが，POSCARファイルには、構造データに加えて、初期速度を別のブロックとして含めることができる．また、原子位置の拘束を行うかどうかの入力も可能である．</p>

<p>拘束分子動力学とバイアス分子動力学（Constrained molecular dynamics, Metadynamics and Biased molecular dynamics）には、ICONSTファイルという追加の入力ファイルが必要で，このファイルは集団変数を指定する．(ICONST)ファイルは、幾何学的パラメータのモニタリング(Monitoring geometric parameters)にも必要である．</p>

<p>主な出力ファイルである<code class="language-plaintext highlighter-rouge">OUTCAR</code>と<code class="language-plaintext highlighter-rouge">OSZICAR</code>の他に、MDトラジェクトリを含む<code class="language-plaintext highlighter-rouge">XDATCAR</code>が重要な出力ファイルである．分子動力学計算のもう一つの重要な出力ファイルは <code class="language-plaintext highlighter-rouge">REPORT</code> ファイルで，このファイルには様々な重要な情報が含まれており、特に<code class="language-plaintext highlighter-rouge">ICONST</code>ファイルを使用した計算では重要である．</p>

<h2 id="incarファイルで必要な設定">INCARファイルで必要な設定</h2>
<p><a href="https://www.vasp.at/wiki/index.php/Molecular_dynamics_calculations">VASPのページ</a>も確認してください．</p>

<p>まず，MDを実行するにあたり欠かせない設定が以下の3つである．</p>
<ol>
  <li>IBRION=0 :: MD計算を実行</li>
  <li>POTIM    :: MDの時間ステップをfs単位で指定.</li>
  <li>NSW      :: 分子動力学計算で実行するステップ数</li>
</ol>

<p>追加でサーモスタットに関する項目の設定がある．</p>
<ol>
  <li>MDALGO   :: サーモスタットの種類の決定</li>
  <li>TEBEG    :: サーモスタットを使用する場合、分子動力学計算を実行する温度をK単位で指定．</li>
  <li>ISIF     :: NVTアンサンブルまたはNpTアンサンブルを選択する場合に必要.</li>
</ol>

<h2 id="出力ファイルの活用">出力ファイルの活用</h2>
<p>MD計算で得られたXDATCARを利用して真面目な計算をする前に，計算が正常に行われているか確認することが必要である．OUTCARやREPORTファイルからこれらの情報を抽出して計算をモニタリングすることが可能である．</p>

<ol>
  <li>エネルギーの変化</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># extract energy from OUTCAR </span>
<span class="nb">grep</span> <span class="s2">"free  energy"</span> OUTCAR|awk <span class="s1">' {print $5}'</span> <span class="o">&gt;</span> energy.dat

<span class="c"># visualizing by gnuplot</span>
gnuplot <span class="nt">-e</span> <span class="s2">"set terminal jpeg; set xlabel 'N_{step}'; set ylabel 'Total energy (eV/cell)';set style data lines; plot 'energy.dat'"</span> <span class="o">&gt;</span> energy.jpg
</code></pre></div></div>

<ol>
  <li>温度の変化</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># extract temperature from REPORT</span>
<span class="nb">grep</span> <span class="s2">" tmprt&gt;"</span> REPORT|awk <span class="s1">' {print $2, $3}'</span> <span class="o">&gt;</span> temperature.dat

<span class="c"># visualizing by gnuplot</span>
gnuplot <span class="nt">-e</span> <span class="s2">"set terminal jpeg; set xlabel 'N_{step}'; set ylabel 'Temperature (K)';set style data lines; plot 'temperature.dat' u 0:2"</span> <span class="o">&gt;</span> temperature.jpg
</code></pre></div></div>

<ol>
  <li>MDトラジェクトリの可視化
XDATCARファイルの軌跡を可視化するには，XDATCARファイルを直接可視化する方法と，一旦他の形式に変換してから可視化する方法がある．XDATCARファイルを直接可視化する簡単な方法はVMDソフトウェアを利用する方法．
VMD → File → New Molecule → Filenameの指定．Determine file typeでは<code class="language-plaintext highlighter-rouge">VASP_XDATCAR5</code>を指定する．</li>
</ol>

<p>もう一つの方法はpythonのASE環境を利用する方法である．この方法なら単に可視化するだけでなく，その後の後処理もできる．<code class="language-plaintext highlighter-rouge">ase.io.vasp.read_vasp_xdatcar</code>関数によって<code class="language-plaintext highlighter-rouge">XDATCAR</code>ファイルを読み込む．第一変数に<code class="language-plaintext highlighter-rouge">XDATCAR</code>ファイルを指定し，第二変数にどのステップ数の構造を取り出すかを指定する．<code class="language-plaintext highlighter-rouge">index=0</code>とした場合には全ての構造を取り出してくれるので，これによってMDステップの数のAtomオブジェクトがリストとして返ってきてでさまざまな処理が可能である．可視化する場合は，このリストを<code class="language-plaintext highlighter-rouge">ase.visualize.view</code>に渡せば良い．</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">ase.io.read</span> <span class="kn">import</span> <span class="n">read_vasp_xdatcar</span>
<span class="kn">from</span> <span class="nn">ase.visualize</span> <span class="kn">import</span> <span class="n">view</span>
<span class="c1"># atomsを読み込み．全ての構造を取り出すにはindex=0とする．
</span><span class="n">atoms</span><span class="o">=</span><span class="n">read_vasp_xdatcar</span><span class="p">(</span><span class="s">"XDATCAR"</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">view</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="xdatcarファイルの他の形式への変換">XDATCARファイルの他の形式への変換</h2>

<h2 id="参考文献">参考文献</h2>
<p><a href="https://mattermodeling.stackexchange.com/questions/3589/how-can-i-visualize-the-trajectory-of-a-vasp-simulation">XDATCARの可視化について</a></p>


      </section>
      <footer>
        
        <p>This project is maintained by <a href="https://github.com/dirac6582">dirac6582</a></p>
        
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="/assets/js/scale.fix.js"></script>
  </body>
</html>
